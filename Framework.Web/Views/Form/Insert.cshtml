
@{
    ViewBag.Title = "新建保修单";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@model dynamic
<style>
    body {
        background-color: white;
    }

    .heard.bar {
        background: -moz-linear-gradient(left,#2e8cbf,#3fbfe6); /*Mozilla*/
        background: -webkit-gradient(linear,0 50%,100% 50%,from(#2e8cbf),to(#3fbfe6)); /*Old gradient for webkit*/
        background: -webkit-linear-gradient(left,#2e8cbf,#3fbfe6); /*new gradient for Webkit*/
        background: -o-linear-gradient(left,#2e8cbf,#3fbfe6); /*Opera11*/
        color: white;
    }

    .heard .title {
        color: white;
    }

    .bar .icon {
        color: white;
    }

    .list-block .item-inner:after {
        background: none;
    }

    .list-block ul:before {
        background: none;
    }

    .list-block {
        margin: 0;
    }

        .list-block .item-title.label {
            text-align: left;
            width: 28%;
            font-size: .7rem;
            color: #333;
        }

        .list-block .item-input {
            border: 1px solid #b4b4b4;
            border-radius: .25rem;
            height: 1.4rem;
            line-height: 1.4rem;
            margin-left: 5px;
            padding: 0 2px;
            font-size: .14rem;
            background-color: #fff;
        }

        .list-block input[type=text], .list-block input[type=password], .list-block input[type=email], .list-block input[type=tel], .list-block input[type=url], .list-block input[type=date], .list-block input[type=datetime-local], .list-block input[type=time], .list-block input[type=number], .list-block input[type=search], .list-block select, .list-block textarea {
            height: 1.4rem;
            line-height: 1.4rem;
            font-size: .25rem;
            color: #333;
        }

        .list-block .item-inner:after {
            background: none;
        }

    .list-block {
        background-color: white;
    }

        .list-block ul {
            margin: 0 3%;
            border-bottom: 1px dashed #888;
        }

    .add_box {
        background: -moz-linear-gradient(left,#2e8cbf,#3fbfe6); /*Mozilla*/
        background: -webkit-gradient(linear,0 50%,100% 50%,from(#2e8cbf),to(#3fbfe6)); /*Old gradient for webkit*/
        background: -webkit-linear-gradient(left,#2e8cbf,#3fbfe6); /*new gradient for Webkit*/
        background: -o-linear-gradient(left,#2e8cbf,#3fbfe6); /*Opera11*/
        font-size: .14rem;
        border: none;
        height: 2rem;
        line-height: 2rem;
        color: white;
        width: 62%;
        border-radius: 5px;
        margin-left: 34%;
    }

    .email_box {
        font-size: .14rem;
        margin-left: 30%;
        margin-top: 5px;
    }

        .email_box img {
            width: 1rem;
            height: auto;
            position: relative;
            top: 5px;
        }

    .footter {
        background: -moz-linear-gradient(left,#2e8cbf,#3fbfe6); /*Mozilla*/
        background: -webkit-gradient(linear,0 50%,100% 50%,from(#2e8cbf),to(#3fbfe6)); /*Old gradient for webkit*/
        background: -webkit-linear-gradient(left,#2e8cbf,#3fbfe6); /*new gradient for Webkit*/
        background: -o-linear-gradient(left,#2e8cbf,#3fbfe6); /*Opera11*/
        text-align: center;
        color: white;
        height: 2.2rem;
        line-height: 2.2rem;
        position: fixed;
        width: 100%;
        bottom: 0;
    }

        .footter img {
            width: 15px;
            margin-right: 10px;
        }

        .footter a {
            color: white;
        }

    .textarea_box {
        position: relative;
        width: 100%;
        border: 1px solid #b4b4b4;
        margin-bottom: 3px;
        border-radius: .25rem;
    }

        .textarea_box textarea {
            height: 4rem;
            width: 100%;
            margin: 0px 5px 10px;
            line-height: 1rem;
        }

    .list-block ul ul {
        padding-left: 0px;
    }

    .textarea_box ul {
        padding: 0 10px;
    }

        .textarea_box ul li {
            width: 1.6rem;
            /*float: left;*/
        }

    .textarea_box .img {
        width: 1.5rem;
        height: 1.5rem;
        border-radius: 5px;
        object-fit: cover;
        margin-right: 3px;
        position: relative;
    }

    .textarea_box .del {
        position: absolute;
        top: -8px;
        right: -6px;
    }

    .list-block ul li.last {
        margin-bottom: 3rem;
    }
</style>
<body>
    <header class="bar bar-nav heard">
        <a class="icon icon-left pull-left"></a>
        <h1 class="title">新建保修单</h1>
    </header>
    <div class="content">
        <div class="list-block">
            <ul>
                <li>
                    <div class="item-content">
                        <div class="item-media"><i class="icon icon-form-email"></i></div>
                        <div class="item-inner">
                            <div class="item-title label">状态</div>
                            <div class="item-input">
                                <input type="text" class="select_box" name="DeviceState" readonly />
                            </div>
                        </div>
                    </div>
                </li>
                <li>
                    <div class="item-content">
                        <div class="item-media"><i class="icon icon-form-email"></i></div>
                        <div class="item-inner">
                            <div class="item-title label">门牌号</div>
                            <div class="item-input">
                                <select class="weui-select" name="iPaymentMethod">
                                    <option value="0">微信二维码</option>
                                    <option value="1">银行卡</option>
                                </select>
                                @*<input id="HouseList_picker" type="text" class="select_box" name="HouseNo" />*@
                            </div>
                        </div>
                    </div>
                </li>
                <li>
                    <div class="item-content">
                        <div class="item-media"><i class="icon icon-form-name"></i></div>
                        <div class="item-inner">
                            <div class="item-title label">班级</div>
                            <div class="item-input">
                                <input type="text"  name="ClassName">
                            </div>
                        </div>
                    </div>
                </li>
            </ul>
        </div>
        <div class="list-block">
            <ul>
                <li>
                    <div class="item-content">
                        <div class="item-media"><i class="icon icon-form-email"></i></div>
                        <div class="item-inner">
                            <div class="item-title label">报修时间</div>
                            <div class="item-input">
                                <input type="text" id='datetime-picker' class="select_box" />
                            </div>
                        </div>
                    </div>
                </li>
                <li>
                    <div class="item-content">
                        <div class="item-media"><i class="icon icon-form-name"></i></div>
                        <div class="item-inner">
                            <div class="item-title label">报修人</div>
                            <div class="item-input">
                                <input type="text" placeholder="Your name">
                            </div>
                        </div>
                    </div>
                </li>
                <!-- Date -->
            </ul>
        </div>
        <div class="list-block">
            <ul>
                <li>
                    <div class="item-content">
                        <div class="item-media"><i class="icon icon-form-email"></i></div>
                        <div class="item-inner">
                            <div class="item-title label">设备类型</div>
                            <div class="item-input">
                                <input type="text" id='picker2' class="select_box" />
                            </div>
                        </div>
                    </div>
                </li>
                <li>
                    <div class="item-content">
                        <div class="item-media"><i class="icon icon-form-name"></i></div>
                        <div class="item-inner">
                            <div class="item-title label">设备名称</div>
                            <div class="item-input">
                                <input type="text" id='picker3' class="select_box" />
                            </div>
                        </div>
                    </div>
                </li>
                <li>
                    <div class="item-content">
                        <div class="item-media"><i class="icon icon-form-email"></i></div>
                        <div class="item-inner">
                            <div class="item-title label">位置</div>
                            <div class="item-input">
                                <input type="text" placeholder="位置">
                            </div>
                        </div>
                    </div>
                </li>
                <!-- Date -->
            </ul>
        </div>
        <div class="list-block">
            <ul>
                <li>
                    <div class="item-content">
                        <div class="item-media"><i class="icon icon-form-email"></i></div>
                        <div class="item-inner">
                            <div class="item-title label">维修单位</div>
                            <div class="item-input">
                                <input type="text" id='picker4' class="select_box" />
                            </div>
                        </div>
                    </div>
                </li>
                <li>
                    <div class="item-content ">
                        <div class="item-media"><i class="icon icon-form-email"></i></div>
                        <div class="item-inner clear">
                            <div class="item-title label">故障描述</div>
                            <div class="textarea_box">
                                <textarea></textarea>
                                <div class="clear">
                                    <ul class="clear">
                                        <li class="clear">
                                            <img src="~/Content/img/login_bg.png" class="img" />
                                            <img src="~/Content/img/del.png" class="del">
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </li>
                <li class="last">
                    <button class="add_box">增加报修</button>
                    <p class="email_box">
                        抄送人：张三（2414769392@qq.com）
                        <img src="~/Content/img/Eadd_icon.png" height="32" width="32" />
                    </p>
                </li>
            </ul>
        </div>
        <div class="footter">
            <a><img src="~/Content/img/tijiao_icon.png" />提交</a>
        </div>
    </div>
</body>
<script type="text/javascript">
    $(function () {
        domin.GetDeviceInfoByCode();
       // domin.initPicker();
    });

    var domin = (function (obj) { return obj; }(new function () {

        //事件绑定
        function bingEvent() {
            //调用扫一扫事件绑定
            $('.footter').on("click", function () {
                WeChat.scanQRCode(function (r) {
                    var deviceCode = r;
                    GetDeviceInfoByCode(deviceCode);
                });
            });
        }

        //获取设备信息
        function GetDeviceInfoByCode(deviceCode) {
            client.ajax.getRequest("/Form/GetDeviceInfoByCode", { deviceCode: deviceCode }, function (r) {
                debugger
                var deviceInfo = r.data.deviceInfo;
                var RealName = r.data.RealName;
                //获取设备信息成功
                $('input[name=HouseNo]').val(deviceInfo.HouseNo);
                $('input[name=ClassName]').val(deviceInfo.ClassName);

                initHouseList(r.data.OrgCode); //初始化门牌号下拉列表
            });
        }

        //初始化门牌号下拉列表
        function initHouseList(OrgCode) {
            //初始化门牌号下拉列表
            client.ajax.getRequest("/Form/GetHouseListByOrgCode", { OrgCode: OrgCode }, function (r) {
                $("#HouseList_picker").picker({
                    title: "请选择门牌号",
                    cols: [
                      {
                          textAlign: 'center',
                          values: ['iPhone 4', 'iPhone 4S', 'iPhone 5']
                      }
                    ]
                });
            });
        }

        //注入微信配置
        function loadWeChatConfig() {
            client.ajax.getRequest("/WeChat/GetWeChatConfig", null, function (r) {
                //获取微信配置
                var appId = r.data.appId;
                var timestamp = r.data.timestamp;
                var nonceStr = r.data.noncestr;
                var signature = r.data.signature;
                WeChat.config(appId, timestamp, nonceStr, signature);
            }, function (r) {
                alert(r.info);
            });
        }
        
        return {
            GetDeviceInfoByCode:GetDeviceInfoByCode,
            bingEvent: bingEvent,
            loadWeChatConfig: loadWeChatConfig
        }
    }));
</script>
